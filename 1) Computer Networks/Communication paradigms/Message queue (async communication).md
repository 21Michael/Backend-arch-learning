# Message queue (async communication)

Асинхронное выполнение операций на платформе Node.js дает существенные преимущества.  
**Это касается и обмена сообщениями:**
  - параллельная обработка сообщений;
  - возможность их хранения неопределенное время с последующей доставкой позднее 
    (**message queue**);
    
**Очереди сообщений** - компоненты, которые являются посредниками между отправителем 
и получателем, хранящими сообщения, пока они не будут доставлены до места назначения.  
Если по какой-либо причине получатель завершит работу, отключится от сети или
окажется под высокой нагрузкой, сообщения будут накапливаться в очереди и переданы 
получателю, когда он вернется в сеть и восстановит свою работоспособность.  
Очередь может находиться внутри отправителя, охватывать отправителя и получателя или
быть помещена в выделенную внешнюю систему, действующую независимо, как промежуточное
программное обеспечение для организации связи.

![link](https://drive.google.com/uc?id=1tLI46wlrzX3ewmqgiuYgP7SxTmx3OhVC)

## Protocols:
  - ### Advanced Message Queuing Protocol (AMQP):
    **Протокол AMQP** – открытый стандартный протокол, поддерживаемый многими
    системами сообщений с очередями. Помимо общего коммуникационного протокола,
    он также определяет модель для описания маршрутизации, фильтрации, организации
    очередей, надежности и безопасности.   
    __   
    ![link](https://drive.google.com/uc?id=1_pAUdfm8IG3dPUN49AixSSMi41jdtmV8)
    __   
    **В AMQP имеются три основных компонента:**
      - **Queue:** структура данных, отвечающая за хранение сообщений, извлекаемых
        получателями. Сообщения из очереди передаются одному или нескольким получателям, 
        которыми, по сути, являются наши приложения. Если к одной очереди подключится 
        несколько получателей, сообщения будут распределяться между ними.  
        __   
        **Очереди могут быть следующих видов:**
          - **Надежные:** очередь автоматически восстанавливается при перезапуске
            брокера. Надежность не означает, что будет сохранено все содержимое 
            очереди; на диск будут сохранены только сообщения, отмеченные как 
            хранимые, и они же будут восстановлены в случае перезагрузки;
          - **Эксклюзивные:** к очереди может быть подключен только один конкретный
            подписчик. После закрытия соединения очередь уничтожается;
          - **Автоматически удаляемые:** очередь удаляется после отключения последнего
            подписчика;
      - **Коммутатор:** Коммутатор направляет сообщения в одну или несколько очередей
        в зависимости от реализуемого алгоритма: 
          - **Прямое коммутирование:** выбор маршрута определяется путем сопоставления 
            полного ключа маршрутизации (например, chat.msg);
          - **Тематическое коммутирование:** выбор маршрута определяется путем 
            сопоставления ключа с шаблоном (например, chat.# соответствует всем 
            ключам маршрутизации, начинающимся с chat);
          - **Разветвляющее коммутирование:** сообщения рассылаются во все подключенные
            очереди, независимо от ключа маршрутизации.
      - **Связь:** между коммутаторами и очередями. Также определяет ключ 
        маршрутизации или шаблон для фильтрации сообщений, поступающих от коммутатора.    
    __   
    Эти компоненты управляются брокером, предоставляющим программный интерфейс для
    создания и управления ими:
    ![link](https://drive.google.com/uc?id=1ZYylhNDvPEEoiHJlb2S_alv9XF0uh1zR)
        
    - ### Message Queue Telemetry Transport (MQTT):
    - ### Simple/Streaming Text Orientated Messaging Protocol (STOMP) : 
    